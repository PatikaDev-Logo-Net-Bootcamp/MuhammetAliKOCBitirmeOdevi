@using Business.DTO
@using UI.Helpers
@{
    ViewData["Title"] = "Mesajlar";
    Layout = "_Layout2";
}
@model List<UserDTO>





<link href="~/css/Message.css" rel="stylesheet" />


<div class="wrapper wrapper-content animated fadeInRight">

    <div class="row">
        <div class="col-lg-12">
            <div class="ibox chat-view">

                <div class="ibox-content">
                    <div class="row">
                        <div class="col-md-9 ">
                            <div class="chat-discussion" data-userid="">

                                <div class="chat-message left">
                                    <img class="message-avatar" src="https://bootdey.com/img/Content/avatar/avatar1.png" alt="">
                                    <div class="message">
                                        <a class="message-author" href="#"> Michael Smith </a>
                                        <span class="message-date"> Mon Jan 26 2015 - 18:39:23 </span>
                                        <span class="message-content">
                                            Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.
                                        </span>
                                    </div>
                                </div>
                                <div class="chat-message right">
                                    <img class="message-avatar" src="https://bootdey.com/img/Content/avatar/avatar6.png" alt="">
                                    <div class="message">
                                        <a class="message-author" href="#"> Karl Jordan </a>
                                        <span class="message-date">  Fri Jan 25 2015 - 11:12:36 </span>
                                        <span class="message-content">
                                            Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text, and a search for 'lorem ipsum' will uncover.
                                        </span>
                                    </div>
                                </div>


                            </div>

                        </div>
                        <div class="col-md-3">
                            <div class="chat-users">





                                <div class="users-list">

                                    @foreach (var item in Model)
                                    {

                                        <div class="chat-user">

                                            @if (String.IsNullOrEmpty(item.PictureUrl))
                                            {
                                                <img class="chat-avatar" src="~/images/EmptyUser.png" alt="User picture">
                                            }
                                            else
                                            {
                                                <img class="chat-avatar" src="@item.PictureUrl" alt="User picture">
                                            }

                                            <div class="chat-user-name">
                                                <span class="ChatUser" data-userid="@item.Id">@(item.FirstName + " " + item.LastName)</span>
                                            </div>
                                        </div>
                                    }




                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-10">
                            <div class="chat-message-form">
                                <div class="form-group">
                                    <textarea class="form-control message-input" id="message" placeholder="Enter message text and press enter"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-2">
                            <div class="chat-message-form">
                                <div class="form-group">
                                    <button type="button" class="btn btn-secondary" style="width:100%; height:100%;" id="SendMessage">Gönder</button>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</div>



@section Scripts {

    <script type="text/javascript">
    var table;
    var clickedRow;
    $(document).ready( function () {

        $("#SendMessage").on("click", function () {

            let receiverUserId = $(".chat-discussion").data("userid");
            let text = $("#message").text();

            console.log(receiverUserId);
            console.log(text);

            $.ajax({
                type: 'POST',
                url: '/Message/AddMessage',
                dataType: 'json',  
                data: data,
                success: function (result) {
                    if (result.isSuccess) {
               
              
                      

    


                        
                    } else {
                        alert(result.errorMessage);
 
                    }
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert(xhr.status);
                    alert(thrownError);
 
                }
            })
        });

    
 


    });
         


    
    </script>

}